const translations = {
    "en": {
        "dashboard": "Dashboard",
        "scan_crop": "Scan Crop",
        "ai_advisor": "AI Advisor",
        "history": "History",
        "profile": "Profile",
        "recommendations": "Recommendations",
        "welcome": "Welcome back, {name}! Your crops are looking healthy today.",
        "quick_actions": "Quick Actions",
        "scan_desc": "Analyze crop health using KisanAI Vision",
        "ask_advisor": "Ask KisanAI Advisor",
        "advisor_desc": "Get instant farming advice via Chat",
        "view_history": "View History",
        "history_desc": "Access past records",
        "weather_alert": "Weather Alert",
        "analyze_now": "Analyze Now",
        "upload_text": "Drag & Drop or Click to Upload",
        "select_image": "Select Image",
        "analysis_result": "Analysis Result",
        "chat_placeholder": "Ask KisanAI about your crop...",
        "send": "Send",
        "crop_recommendation": "Crop Recommendation",
        "fertilizer_recommendation": "Fertilizer Recommendation",
        "get_recommendation": "Get Recommendation",
        "nitrogen": "Nitrogen (N)",
        "phosphorous": "Phosphorous (P)",
        "potassium": "Potassium (K)",
        "temperature": "Temperature (°C)",
        "humidity": "Humidity (%)",
        "ph": "pH Level",
        "rainfall": "Rainfall (mm)",
        "soil_type": "Soil Type",
        "crop": "Crop",
        "market_price": "Market Price",
        "weather": "Weather",
        "export_pdf": "Export PDF",
        "voice_input": "Voice Input",
        "listening": "Listening...",
        "kisan_ai": "KisanAI",
        "powered_by": "Powered by KisanAI",
        "logout": "Logout",
        "scan_history": "Scan History",
        "fetched_from_db": "Fetched from MongoDB Atlas",
        "loading_history": "Loading history...",
        "no_history": "No scan history found. Start by scanning a crop!",
        "confidence_score": "Confidence Score",
        "view_photo": "View Photo",
        "account_secured": "Account Secured",
        "location": "Location",
        "primary_crops": "Primary Crops",
        "farm_size": "Farm Size",
        "account_settings": "Account Settings",
        "email_notifications": "Email Notifications",
        "email_desc": "Receive weekly crop health reports",
        "language": "Language",
        "lang_desc": "Change app language (Hindi/Punjabi/English)",
        "home": "Home",
        "features": "Features",
        "about": "About",
        "login": "Login",
        "smarter_farming": "Smarter Farming with AI",
        "hero_desc": "Detect crop diseases, get AI-powered advice using KisanAI, and manage your farm efficiently.",
        "start_farming": "Start Farming Smarter",
        "ai_features": "AI-Powered Features",
        "empowering_farmers": "Empowering farmers with cutting-edge technology",
        "vision_detection": "KisanAI Vision Detection",
        "vision_desc": "Upload photos of crops to instantly detect diseases and receive treatment advice powered by KisanAI Vision.",
        "kisan_advisor": "KisanAI Advisor",
        "advisor_feature_desc": "Chat with our smart AI assistant to get real-time answers to your farming queries in any language.",
        "voice_assistance": "Voice Assistance",
        "voice_desc": "Speak to the app naturally. Our multimodal AI understands voice commands for hands-free farming help.",
        "tech_stack_title": "Powered by Modern Cloud & AI Technology",
        "kisan_intelligence": "KisanAI Intelligence",
        "secure_login": "Auth0 Secure Login",
        "built_using": "Built using Advanced AI, MongoDB Atlas, and Auth0.",
        "cloud_ready": "Cloud-ready, secure, and AI-powered."
    },
    "hi": {
        "dashboard": "डैशबोर्ड",
        "scan_crop": "फसल स्कैन करें",
        "ai_advisor": "एआई सलाहकार",
        "history": "इतिहास",
        "profile": "प्रोफाइल",
        "recommendations": "सिफारिशें",
        "welcome": "वापसी पर स्वागत है, {name}! आपकी फसलें आज स्वस्थ दिख रही हैं।",
        "quick_actions": "त्वरित कार्रवाई",
        "scan_desc": "KisanAI विजन का उपयोग करके फसल स्वास्थ्य का विश्लेषण करें",
        "ask_advisor": "KisanAI सलाहकार से पूछें",
        "advisor_desc": "चैट के माध्यम से तत्काल कृषि सलाह प्राप्त करें",
        "view_history": "इतिहास देखें",
        "history_desc": "पिछले रिकॉर्ड तक पहुंचें",
        "weather_alert": "मौसम चेतावनी",
        "analyze_now": "अभी विश्लेषण करें",
        "upload_text": "खींचें और छोड़ें या अपलोड करने के लिए क्लिक करें",
        "select_image": "छवि चुनें",
        "analysis_result": "विश्लेषण परिणाम",
        "chat_placeholder": "अपनी फसल के बारे में KisanAI से पूछें...",
        "send": "भेजें",
        "crop_recommendation": "फसल की सिफारिश",
        "fertilizer_recommendation": "उर्वरक की सिफारिश",
        "get_recommendation": "सिफारिश प्राप्त करें",
        "nitrogen": "नाइट्रोजन (N)",
        "phosphorous": "फॉस्फोरस (P)",
        "potassium": "पोटेशियम (K)",
        "temperature": "तापमान (°C)",
        "humidity": "आर्द्रता (%)",
        "ph": "pH स्तर",
        "rainfall": "वर्षा (mm)",
        "soil_type": "मिट्टी का प्रकार",
        "crop": "फसल",
        "market_price": "बाजार मूल्य",
        "weather": "मौसम",
        "export_pdf": "PDF निर्यात करें",
        "voice_input": "वॉयस इनपुट",
        "listening": "सुन रहा हूँ...",
        "kisan_ai": "KisanAI",
        "powered_by": "KisanAI द्वारा संचालित",
        "logout": "लॉग आउट",
        "scan_history": "स्कैन इतिहास",
        "fetched_from_db": "MongoDB एटलस से प्राप्त",
        "loading_history": "इतिहास लोड हो रहा है...",
        "no_history": "कोई स्कैन इतिहास नहीं मिला। एक फसल स्कैन करके शुरू करें!",
        "confidence_score": "विश्वास स्कोर",
        "view_photo": "फोटो देखें",
        "account_secured": "खाता सुरक्षित",
        "location": "स्थान",
        "primary_crops": "प्राथमिक फसलें",
        "farm_size": "खेत का आकार",
        "account_settings": "खाता सेटिंग्स",
        "email_notifications": "ईमेल सूचनाएं",
        "email_desc": "साप्ताहिक फसल स्वास्थ्य रिपोर्ट प्राप्त करें",
        "language": "भाषा",
        "lang_desc": "ऐप भाषा बदलें (हिंदी/पंजाबी/अंग्रेजी)",
        "home": "होम",
        "features": "सुविधाएँ",
        "about": "हमारे बारे में",
        "login": "लॉग इन",
        "smarter_farming": "AI के साथ स्मार्ट खेती",
        "hero_desc": "फसल रोगों का पता लगाएं, KisanAI का उपयोग करके AI-संचालित सलाह प्राप्त करें, और अपने खेत का कुशलतापूर्वक प्रबंधन करें।",
        "start_farming": "स्मार्ट खेती शुरू करें",
        "ai_features": "AI-संचालित सुविधाएँ",
        "empowering_farmers": "अत्याधुनिक तकनीक के साथ किसानों को सशक्त बनाना",
        "vision_detection": "KisanAI विजन डिटेक्शन",
        "vision_desc": "फसल की फोटो अपलोड करें और तुरंत रोगों का पता लगाएं और KisanAI विजन द्वारा संचालित उपचार सलाह प्राप्त करें।",
        "kisan_advisor": "KisanAI सलाहकार",
        "advisor_feature_desc": "किसी भी भाषा में अपनी कृषि संबंधी प्रश्नों के रीयल-टाइम उत्तर प्राप्त करने के लिए हमारे स्मार्ट AI सहायक से चैट करें।",
        "voice_assistance": "वॉयस सहायता",
        "voice_desc": "ऐप से स्वाभाविक रूप से बात करें। हमारा मल्टीमॉडल AI हैंड्स-फ्री खेती मदद के लिए वॉयस कमांड समझता है।",
        "tech_stack_title": "आधुनिक क्लाउड और AI तकनीक द्वारा संचालित",
        "kisan_intelligence": "KisanAI इंटेलिजेंस",
        "secure_login": "Auth0 सुरक्षित लॉग इन",
        "built_using": "उन्नत AI, MongoDB एटलस और Auth0 का उपयोग करके बनाया गया।",
        "cloud_ready": "क्लाउड-रेडी, सुरक्षित और AI-संचालित।",
        "about_title": "कृषि में क्रांति",
        "about_desc_1": "KisanAI Live किसानों को अत्याधुनिक आर्टिफिशियल इंटेलिजेंस के साथ सशक्त बनाने के लिए समर्पित है। हमारा मानना है कि तकनीक सभी के लिए सुलभ होनी चाहिए, जो खाद्य उत्पादन के भविष्य को सुरक्षित करने में मदद करे।",
        "about_desc_2": "हमारा प्लेटफॉर्म फसल रोगों का पता लगाने के लिए उन्नत कंप्यूटर विजन को एक संवादात्मक AI सलाहकार के साथ जोड़ता है ताकि आपकी खेती की जरूरतों के लिए व्यापक सहायता प्रदान की जा सके।",
        "accuracy": "सटीकता",
        "support": "AI सहायता",
        "crops": "फसलें"
    }
};

function setLanguage(lang) {
    localStorage.setItem('language', lang);
    applyTranslations(lang);
}

function applyTranslations(lang) {
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            el.textContent = translations[lang][key];
        }
    });

    // Handle placeholders
    const inputs = document.querySelectorAll('[data-i18n-placeholder]');
    inputs.forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (translations[lang][key]) {
            el.placeholder = translations[lang][key];
        }
    });

    // Handle dynamic text like welcome message
    const welcomeMsg = document.getElementById('welcome-msg');
    if (welcomeMsg) {
        const name = localStorage.getItem('user_name') || 'Farmer';
        welcomeMsg.textContent = translations[lang]['welcome'].replace('{name}', name);
    }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    const lang = localStorage.getItem('language') || 'en';
    applyTranslations(lang);
    
    // Add language toggle if not exists
    if (!document.getElementById('lang-toggle')) {
        const sidebar = document.querySelector('.sidebar');
        const navLinks = document.querySelector('.nav-links');
        
        if (sidebar) {
            const toggleDiv = document.createElement('div');
            toggleDiv.id = 'lang-toggle';
            toggleDiv.style.padding = '20px';
            toggleDiv.style.textAlign = 'center';
            toggleDiv.innerHTML = `
                <select onchange="setLanguage(this.value)" style="padding: 5px; border-radius: 5px;">
                    <option value="en" ${lang === 'en' ? 'selected' : ''}>English</option>
                    <option value="hi" ${lang === 'hi' ? 'selected' : ''}>हिंदी</option>
                </select>
            `;
            sidebar.appendChild(toggleDiv);
        } else if (navLinks) {
            // Add to navbar for index.html
            const toggleLink = document.createElement('a');
            toggleLink.id = 'lang-toggle';
            toggleLink.href = "#";
            toggleLink.innerHTML = `
                <select onchange="setLanguage(this.value)" style="padding: 5px; border-radius: 5px; background: transparent; border: 1px solid white; color: white;">
                    <option value="en" ${lang === 'en' ? 'selected' : ''} style="color: black;">EN</option>
                    <option value="hi" ${lang === 'hi' ? 'selected' : ''} style="color: black;">HI</option>
                </select>
            `;
            // Insert before the login button (last element)
            navLinks.insertBefore(toggleLink, navLinks.lastElementChild);
        }
    }
});
